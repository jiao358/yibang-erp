# AI Excel 任务管理中心

## 功能概述

这是一个完整的AI Excel任务管理中心，提供Excel文件上传、AI智能处理、任务监控和结果查看等功能。

## 主要功能

### 1. 任务概览
- **统计卡片**: 显示总任务数、处理中、成功、失败的数量
- **快速操作**: 上传新文件、刷新数据、查看全部任务

### 2. 任务筛选
- **基础筛选**: 状态、时间范围、文件名、排序方式
- **高级筛选**: 行数范围、成功率、处理时长
- **实时筛选**: 输入即筛选，无需点击按钮

### 3. 任务列表
- **表格展示**: 任务ID、文件名、状态、进度、统计信息
- **进度可视化**: 进度条显示处理进度
- **操作按钮**: 查看详情、重新处理、删除任务
- **分页支持**: 支持分页和每页数量调整

### 4. 任务详情
- **基本信息**: 任务ID、文件名、供应商、时间等
- **处理统计**: 总行数、成功、失败、手动处理
- **实时进度**: 处理中状态的详细进度
- **操作功能**: 查看结果、重新处理、下载、日志等

## 使用说明

### 开发模式 vs 生产模式

页面顶部有一个开发模式开关：

- **开发模式**: 使用模拟数据，适合前端开发和测试
- **生产模式**: 使用真实API，连接后端服务

### 上传Excel文件

1. 点击"上传新文件"按钮
2. 选择Excel文件
3. 配置AI参数（可选）
4. 点击"开始处理"
5. 监控处理进度

### 查看任务详情

1. 在任务列表中点击"查看详情"按钮
2. 查看任务的详细信息
3. 执行相关操作（重试、下载、删除等）

### 筛选和搜索

1. 使用筛选面板设置筛选条件
2. 支持多条件组合筛选
3. 实时查看筛选结果

## 技术特性

### 响应式设计
- 支持桌面端和移动端
- 自适应布局
- 触摸友好的交互

### 实时更新
- 自动刷新任务状态
- 进度条动画
- 状态变更通知

### 错误处理
- 详细的错误信息
- 优雅的降级处理
- 用户友好的提示

### 性能优化
- 分页加载
- 数据缓存
- 懒加载组件

## 开发说明

### 组件结构
```
AIExcelImport.vue (主容器)
├── TaskOverview.vue (任务概览)
├── TaskFilter.vue (任务筛选)
├── TaskTable.vue (任务列表)
├── TaskDetailDialog.vue (任务详情)
└── 其他辅助组件
```

### 数据流
1. 页面加载时调用 `loadTaskHistory()`
2. 筛选条件变化时更新 `filteredTasks`
3. 用户操作触发相应的API调用
4. 实时更新任务状态和进度

### 模拟数据
当API调用失败时，系统会自动切换到模拟数据模式，确保界面能正常显示和测试。

## 注意事项

1. **浏览器兼容性**: 支持现代浏览器（Chrome、Firefox、Safari、Edge）
2. **网络要求**: 生产模式需要稳定的网络连接
3. **权限控制**: 需要有效的用户认证Token
4. **文件格式**: 支持Excel文件（.xlsx, .xls）

## 故障排除

### 常见问题

1. **页面无法加载**: 检查网络连接和用户认证状态
2. **数据不显示**: 切换到开发模式查看模拟数据
3. **操作失败**: 查看控制台错误信息和网络请求状态

### 调试模式

打开浏览器开发者工具，查看控制台日志：
- 🚀 页面生命周期事件
- 🔄 API调用状态
- 📥 数据加载结果
- ❌ 错误信息详情

## 更新日志

- **v1.0.0**: 初始版本，包含基础任务管理功能
- **v1.1.0**: 添加开发模式开关和模拟数据支持
- **v1.2.0**: 优化错误处理和用户体验
